test_wait_for_no_retries() {
    trap 'assert "false" "Script exited unexpectedly"' EXIT
    export KUBECTL_TRACKER=$(pwd)/resources/kubectl-tracker
    rm -f $KUBECTL_TRACKER
    PATH=$(pwd)/resources:$PATH
    export MAX_RETRIES=0

     echo "Started executing script"
    ../wait_for.sh job test-job
     echo "script completed execution"

    assert "test $? -eq 1" "The wait_for job should not have retried and should have given exit code 1"
    echo "Reached for no-retries test"
    trap - EXIT
}

test_wait_for_one_retry() {
    sleep 60
    export KUBECTL_TRACKER=$(pwd)/resources/kubectl-tracker
    rm -f $KUBECTL_TRACKER
    PATH=$(pwd)/resources:$PATH
    export MAX_RETRIES=1
    
    ../wait_for.sh job test-job

    assert "test $? -eq 0" "The wait_for job should have retried once and given exit code 0"
    echo "Reached for one retry test"
}

teardown() {
    rm -f $(pwd)/resources/kubectl-tracker
}